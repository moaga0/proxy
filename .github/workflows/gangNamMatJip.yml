name: GangNamMatJip HTML Fetch

on:
  workflow_dispatch: # 수동 실행

jobs:
  fetch-html:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Fetch GangNamMatJip Visit HTML
        run: |
          mkdir -p html_cache/visit
          for ca in 2005 2010 2015 2020 2025 2030 2035; do
            for page in {0..5}; do
              url="https://xn--939au0g4vj8sq.net/theme/go/_list_cmp_tpl.php?ca=$ca&rpage=$page&row_num=28"
              curl -s "$url" -o "html_cache/visit/${ca}_page_${page}.html"
            done
          done

      - name: Fetch GangNamMatJip Shipping HTML
        run: |
          mkdir -p html_cache/shipping
          for ca in 3005 3010 3015 3020 3030; do
            for page in {0..5}; do
              url="https://xn--939au0g4vj8sq.net/theme/go/_list_cmp_tpl.php?ca=$ca&rpage=$page&row_num=28"
              curl -s "$url" -o "html_cache/shipping/${ca}_page_${page}.html"
            done
          done

      - name: Commit & Push HTML
        run: |
          git config --local user.name "github-actions[bot]"
          git config --local user.email "github-actions[bot]@users.noreply.github.com"
          git add html_cache/
          git commit -m "Update GangNamMatJip HTML cache [ci skip]" || echo "No changes"
          git push
